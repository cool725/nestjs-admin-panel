<ng-template #profileGender>
  <ng-template #genderReqStar>
    <span
      class="text-danger"
      *ngIf="formProfile.controls['gender']?.hasError('required')"
      >*</span
    >
  </ng-template>
  <div [formGroup]="formProfile">
    <div class="form-check form-check-inline ml-1">
      <input
        formControlName="gender"
        class="form-check-input"
        type="radio"
        id="radio-male"
        value="M"
      />
      <label class="form-check-label" for="radio-male"
        ><ng-container [ngTemplateOutlet]="genderReqStar"></ng-container>
        Male</label
      >
    </div>
    <div class="form-check form-check-inline ml-1">
      <input
        formControlName="gender"
        class="form-check-input"
        type="radio"
        id="radio-woman"
        value="W"
      />
      <label class="form-check-label" for="radio-woman">Woman</label>
    </div>
    <div class="form-check form-check-inline ml-1">
      <input
        formControlName="gender"
        class="form-check-input"
        type="radio"
        id="radio-company"
        value="C"
      />
      <label class="form-check-label" for="radio-company">Firma</label>
    </div>
  </div>
</ng-template>

<ng-template #profileName>
  <ng-template #genderReqStar>
    <span
      class="text-danger"
      *ngIf="formProfile.controls['gender']?.hasError('required')"
      >*</span
    >
  </ng-template>
  <div [formGroup]="formProfile"></div>
</ng-template>

<ng-container *ngIf="api.profile$ | async as profile">
  <ng-container *ngIf="viewSettings.type === 'modal'">
    <div class="modal-header">
      <span>#{{ profile.profileId }}</span>
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="modal"
        aria-label="Close"
      ></button>
    </div>
    <div class="modal-header-sub">
      <select
        (change)="viewSettings.changeMode($event.target.value)"
        [(ngModel)]="viewSettings.mode"
        class="form-control bg-transparent text-white"
      >
        <option value="simple">Einfach</option>
        <option value="details">Detailiert</option>
      </select>
    </div>

    <div *ngIf="viewSettings.mode === 'simple'" class="modal-body">
      <form class="row" [formGroup]="formProfile">
        <div class="col-12 mb-3">
          <ng-container [ngTemplateOutlet]="profileGender"></ng-container>
        </div>

        <ng-container *ngIf="profileType === 'C'">
          <div class="col-12 col-md-9 row">
            <div class="col-12 col-md-12">
              <label>Title</label>
              <div class="input-group mb-3">
                <span class="input-group-text" id="profiles-title">@</span>
                <input
                  formControlName="title"
                  type="text"
                  class="form-control"
                  autocomplete="new-password"
                  placeholder="Title"
                  aria-label="title"
                  aria-describedby="profiles-title"
                />
              </div>
            </div>
          </div>
        </ng-container>
        <ng-container>
          <div class="col-12 col-md-9 row">
            <div class="col-12 col-md-6">
              <label>Nachname</label>
              <div class="input-group mb-3">
                <span class="input-group-text" id="profiles-lastname">@</span>
                <input
                  formControlName="lastName"
                  type="text"
                  class="form-control"
                  autocomplete="new-password"
                  placeholder="Nachname"
                  aria-label="lastName"
                  aria-describedby="profiles-lastname"
                />
              </div>
            </div>
            <div class="col-12 col-md-6">
              <label>Vorname</label>
              <div class="input-group mb-3">
                <span class="input-group-text" id="profles-firstname">@</span>
                <input
                  formControlName="firstName"
                  type="text"
                  class="form-control"
                  autocomplete="new-password"
                  placeholder="Vorname"
                  aria-label="firstName"
                  aria-describedby="profiles-firstname"
                />
              </div>
            </div>
          </div>
          <div class="col-12 col-md-3 d-none d-md-block">
            <div class="form-group position-relative">
              <img
                style="max-width: 100px; position: absolute"
                src="https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_1280.png"
              />
            </div>
          </div>
        </ng-container>

        <div class="col-12 col-md-9 row">
          <div class="col-12 col-md-6">
            <label>Email</label>
            <div class="input-group mb-3">
              <span class="input-group-text" id="profiles-email">@</span>
              <input
                type="text"
                formControlName="email"
                class="form-control"
                autocomplete="new-password"
                placeholder="Email"
                aria-label="email"
                aria-describedby="profiles-email"
              />
            </div>
          </div>
          <div class="col-12 col-md-6">
            <label>Telefon</label>
            <div class="input-group mb-3">
              <span class="input-group-text" id="profles-phone">@</span>
              <input
                formControlName="phone"
                type="text"
                class="form-control"
                autocomplete="new-password"
                placeholder="Phone"
                aria-label="phone"
                aria-describedby="profiles-phone"
              />
            </div>
          </div>
        </div>

        <hr />
        <div class="col-12 row">
          <div class="col-12 col-md-4">
            <label>Geburtstag</label>
            <div class="input-group mb-3">
              <span class="input-group-text" id="profiles-birthday">@</span>
              <input
                type="date"
                formControlName="birthDay"
                class="form-control"
                autocomplete="new-password"
                aria-label="birthday"
                aria-describedby="profiles-birthday"
              />
            </div>
          </div>
          <div class="col-12 col-md-4">
            <label>VIP</label>
            <div class="input-group mb-3">
              <span class="input-group-text" id="profiles-vip">@</span>
              <select
                formControlName="vip"
                class="form-control"
                autocomplete="new-password"
                aria-label="lastName"
                aria-describedby="profiles-vip"
              >
                <option value="">Nein</option>
                <option value="1">A</option>
                <option value="2">B</option>
                <option value="3">C</option>
                <option value="4">D</option>
              </select>
            </div>
          </div>
          <div class="col-12 col-md-4">
            <label>Sprache *</label>
            <div class="input-group mb-3">
              <span class="input-group-text" id="profiles-language">@</span>
              <select
                formControlName="languageId"
                class="form-control"
                autocomplete="new-password"
                aria-label="language"
                aria-describedby="profiles-language"
              >
                <option value="1">Deutsch</option>
              </select>
            </div>
          </div>
        </div>
        <div class="col-12 row">
          <div class="col-12 col-md-4">
            <label>Kundensegment</label>
            <div class="input-group mb-3">
              <nz-select
                class="w-100"
                formControlName="segments"
                nzMode="multiple"
                nzPlaceHolder="Please select"
                aria-label="segments"
                aria-describedby="profiles-vip"
              >
                <nz-option
                  *ngFor="let segment of segments$ | async"
                  [nzLabel]="segment.title"
                  [nzValue]="segment.segmentId"
                ></nz-option>
              </nz-select>
            </div>
          </div>
          <div class="col-12 col-md-4">
            <label>Preisklasse</label>
            <div class="input-group mb-3">
              <nz-select
                class="w-100"
                formControlName="priceClass"
                multiple
                aria-label="priceclass"
                aria-describedby="profiles-priceclass"
              >
              </nz-select>
            </div>
          </div>
          <div class="col-12 col-md-4">
            <label>Source</label>
            <div class="input-group mb-3">
              <nz-select
                class="w-100"
                formControlName="source"
                multiple
                aria-label="source"
                aria-describedby="profiles-source"
              >
              </nz-select>
            </div>
          </div>
        </div>
      </form>
    </div>
    <div *ngIf="viewSettings.mode === 'details'" class="modal-body">
      <div class="row col-12 col-md-6">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
          <li class="nav-item" role="presentation">
            <button
              class="nav-link active"
              id="home-tab"
              data-bs-toggle="tab"
              data-bs-target="#home"
              type="button"
              role="tab"
              aria-controls="home"
              aria-selected="true"
            >
              Home
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="profile-tab"
              data-bs-toggle="tab"
              data-bs-target="#profile"
              type="button"
              role="tab"
              aria-controls="profile"
              aria-selected="false"
            >
              Profile
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="contact-tab"
              data-bs-toggle="tab"
              data-bs-target="#contact"
              type="button"
              role="tab"
              aria-controls="contact"
              aria-selected="false"
            >
              Contact
            </button>
          </li>
        </ul>
        <div class="tab-content" id="myTabContent">
          <div
            class="tab-pane fade show active"
            id="home"
            role="tabpanel"
            aria-labelledby="home-tab"
          >
            <div class="row shadow">
              <div class="col-12 mb-3">
                <ng-container [ngTemplateOutlet]="profileGender"></ng-container>
              </div>

              <div class="col-12 mb-3">
                <ng-container [ngTemplateOutlet]="profileGender"></ng-container>
              </div>
            </div>
          </div>
          <div
            class="tab-pane fade"
            id="profile"
            role="tabpanel"
            aria-labelledby="profile-tab"
          >
            ...
          </div>
          <div
            class="tab-pane fade"
            id="contact"
            role="tabpanel"
            aria-labelledby="contact-tab"
          >
            ...
          </div>
        </div>
      </div>
      <div class="row col-12 col-md-6"></div>
    </div>

    <div class="modal-footer">
      <button
        *ngIf="profile.profileId"
        (click)="delete(profile.profileId)"
        type="button"
        class="btn btn-danger text-white"
      >
        Löschen
      </button>
      <button
        (click)="closeModal()"
        type="button"
        class="btn btn-primary text-white"
        data-bs-dismiss="modal"
      >
        Abbrechen
      </button>
      <button
        (click)="save(profile)"
        type="button"
        class="btn btn-success text-white"
      >
        Speichern
      </button>
    </div>
  </ng-container>
  <ng-container></ng-container>
  <ng-container></ng-container>
</ng-container>
